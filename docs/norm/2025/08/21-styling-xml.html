<!DOCTYPE HTML><html xmlns="http://www.w3.org/1999/xhtml">
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  
  <title>Serving and styling XML on the web</title>
  <meta name="author" content="Norm Tovey-Walsh">
  <meta name="pubdate" content="2025-08-21T11:00:00">
  <link rel="shortcut icon" href="/img/scicon-032.png" type="image/png">
  <style>pre {
  background-color: rgb(227, 236, 237);
  border: 1px solid rgb(180, 194, 214);
  border-radius: 0.25em;
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  padding-left: 1em;
  padding-right: 1em;
}
p code {
  white-space: nowrap;
}
</style>
<link rel="stylesheet" type="text/css" href="/css/blog.css"><link rel="stylesheet" type="text/css" href="/css/norm-tovey-walsh.css"><meta content="Saxon Chronicles (in a Norman style)" property="og:site_name"><meta content="https://blog.saxonica.com/img/sccard.png" property="og:image"><meta content="Norm Tovey-Walsh's Saxonica weblog." property="og:description"><meta content="https://blog.saxonica.com/norm" property="og:url"><meta content="600" property="og:image:width"><meta content="315" property="og:image:height"><meta content="Serving and styling XML on the web" property="og:title"><meta content="en_GB" property="og:locale"><meta content="website" property="og:type"><meta name="viewport" content="width=device-width, initial-scale=1.0"></head>
<body class="norm-tovey-walsh"><header><div class="banner"><h1><a href="/norm/">Saxon Chronicles</a></h1><div class="tagline">( in a Norman style )</div></div><h2>Serving and styling XML on the web</h2><aside class="nav"><div class="navlinks"><div id="search"><form action="https://www.google.com/search" target="_parent"><span>Search: </span><input size="20" name="as_q"><input type="hidden" name="hl" value="en"><input type="hidden" name="ie" value="UTF-8"><input type="hidden" name="btnG" value="Google+Search"><input type="hidden" name="as_qdr" value="all"><input type="hidden" name="as_occt" value="any"><input type="hidden" name="as_dt" value="i"><input type="hidden" name="as_sitesearch" value="blog.saxonica.com"></form></div><div id="blogroll"><a href="/">Home (combined archives)</a><br><a href="/announcements/">Announcements</a><br><a href="/mike/">Saxon diaries</a><br><a href="/oneil/">O’Neil Delpratt’s Blog</a><br><a href="/norm/">Saxon Chronicles</a></div></div></aside><div class="byline"><span class="by">By </span><span class="name"><a href="/authors.html#norm-tovey-walsh">Norm Tovey-Walsh</a></span><span class="on"> on </span><a href="/authors.html#norm-tovey-walsh-D2025-08"><span class="date" time="2025-08-21T11:00:00">August&nbsp;21, 2025 at 11:00a.m.</span></a></div></header><main>


<p>For more than twenty years, it’s been possible to serve XML documents on the
web, making them available to applications as well-formed XML and to humans as
nicely formatted web pages. This is a win-win scenario for many users, but the
<a href="https://whatwg.org/">WHATWG</a> is moving aggressively to take away
this long-standing web capability.</p>

<p>The WHATWG is moving to deprecate, and then remove, native support for XSLT
in the browser. It’s XSLT that provides the formatted web page from an XML
document. Faced with the prospect of losing native support for XSLT in the
browser, a natural question our users ask is “can we use SaxonJS instead?” The
answer is yes, but it’s a little bit complicated.</p>

<p>Let’s step back for a moment and look (broadly) at how the web works and what’s
actually going on under the hood.</p>

<p>For the application, this is simple: it requests the web page; it gets back a
document with an <code>application/xml</code> media type; it parses it; and it does what it
does with the XML data. Job done.</p>

<p>For the human user reading the page with a web browser, there’s a little bit
more going on.</p>

<ol type="1">
<li>The browser requests the page.</li>
<li>It gets back an <code>application/xml</code> page and parses it.</li>
<li>If the page has an <code>xml-stylesheet</code> processing instruction:
  <ol type="a">
    <li>The browser loads the stylesheet that the processing instruction points to;</li>
    <li>if it’s an XSLT stylesheet, it transforms the XML document with the stylesheet;</li>
    <li>and it displays the transformed result to the reader</li>
  </ol>
</li>
</ol>
   
<p>(If the document doesn’t have an <code>xml-stylesheet</code> processing instruction, the
browser just displays the raw XML in some way or another. How useful this is
depends on the browser and the XML markup.)</p>

<p>It’s the fact that the browser recognizes, and responds to, the
<code>xml-stylesheet</code> processing instruction that starts the process off.
This document:</p>

<pre><code>&lt;?xml-stylesheet href="/xslt/atom.xsl" type="text/xsl"?&gt;
&lt;feed xmlns="http://www.w3.org/2005/Atom"
      xmlns:dc="http://purl.org/dc/elements/1.1/"
      xmlns:dcterms="http://purl.org/dc/terms/"
      xml:lang="EN-us"&gt;
   &lt;title&gt;Saxonica Weblogs&lt;/title&gt;
   &lt;link href="https://blog.saxonica.com/" rel="alternate" type="text/html"/&gt;
   &lt;link href="https://blog.saxonica.com/atom.xml" rel="self"/&gt;
   &lt;id&gt;https://blog.saxonica.com/atom.xml&lt;/id&gt;
   …
</code></pre>

<p>Will be styled with the <code>/xslt/atom.xsl</code> stylesheet before being
displayed because the <code>xml-stylesheet</code> processing intruction on the
first line tells it to.</p>

<p>If WHATWG takes away that capability, the XML document becomes inert.</p>

<p>The challenge that we, as users, face is to find some place to stand from
which we can begin the styling process. The more common SaxonJS use case begins
with an HTML browser page, and it’s obvious how to bootstrap a JavaScript
application from there.</p>

<p>Luckily, for the moment at least, the browser will run scripts that are
embedded in the XML using the <code>script</code> element in the HTML namespace.
So that’s where we can stand. If we remove the processing instruction and add
script lines, we can run SaxonJS:</p>

<pre><code>&lt;feed xmlns="http://www.w3.org/2005/Atom"
      xmlns:dc="http://purl.org/dc/elements/1.1/"
      xmlns:dcterms="http://purl.org/dc/terms/"
      xml:lang="EN-us"&gt;

   &lt;script xmlns="http://www.w3.org/1999/xhtml"
           type="text/javascript" src="/js/saxon-js/SaxonJS2.rt.js"&gt;&lt;/script&gt;
   &lt;script xmlns="http://www.w3.org/1999/xhtml"&gt;
      SaxonJS.transform({
        stylesheetLocation: "/xslt/atom.sef.json",
        initialTemplate: "main"
      }, "async");
   &lt;/script&gt;

   &lt;title&gt;Saxonica Weblogs&lt;/title&gt;
   &lt;link href="https://blog.saxonica.com/" rel="alternate" type="text/html"/&gt;
   &lt;link href="https://blog.saxonica.com/atom.xml" rel="self"/&gt;
   &lt;id&gt;https://blog.saxonica.com/atom.xml&lt;/id&gt;
   …
</code></pre>

<p>I’m not going to try to give a SaxonJS tutorial here, but in brief: the first
script loads SaxonJS; the second script loads the <em>compiled</em> version of the stylesheet,
<code>/xslt/atom.sef.json</code>, and runs the template named “<code>main</code>”.
</p>

<p>The <code>/xslt/atom.xsl</code> stylesheet can remain mostly the same as the
one you’re using currently in the browser except, of course, that you can now
use XSLT 3.0 features.
One complication is that you have to add two templates to your XSLT
stylesheet. The easiest way to do that is by placing these lines in a file
called <code>saxonjs-templates.xsl</code>:</p>

<pre><code>&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ixsl="http://saxonica.com/ns/interactiveXSLT"
                version="3.0"&gt;

&lt;xsl:template name="main"&gt;
  &lt;xsl:apply-templates select="ixsl:page()" mode="format-feed"/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="/" mode="format-feed"&gt;
  &lt;xsl:result-document href="?." method="ixsl:replace-content"&gt;
    &lt;xsl:apply-templates select="."/&gt;
  &lt;/xsl:result-document&gt;
&lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;</code></pre>

<p>The first template is the one that is run from the script in the XML
document. It doesn’t have to be named “<code>main</code>” but the names used in
both places have to be the same. This template takes the current page, the XML
document, and processes it in the <code>format-feed</code> mode.</p>

<p>The second template just uses <code>xsl:apply-templates</code> on itself to
process the XML document in the default mode, this will run the rest of your
stylesheet, <code>/xslt/atom.xsl</code>. Surrounding that call to
apply-templates is an <code>xsl:result-document</code> instruction that will have the effect
of replacing the current document with the styled result. That’s what “<code>?.</code>” and
<code>ixsl:replace-content</code> achieve.</p>

<p>Use <code>xsl:include</code> at the top of <code>/xslt/atom.xsl</code> to include
the contents of <code>saxonjs-templates.xsl</code>:</p>

<pre><code>&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:atom="http://www.w3.org/2005/Atom"
                xmlns="http://www.w3.org/1999/xhtml" 
                exclude-result-prefixes="#all"
                version="3.0"&gt;
&lt;xsl:include href="saxonjs-templates.xsl"/&gt;
&lt;xsl:output method="html" html-version="5"
            encoding="utf-8" indent="no"/&gt;
  ...
</code></pre>

<p>I’ve taken the opportunity to update the version and the
<code>xsl:output</code> method as well, since we’re now using XSLT 3.0 not 1.0.</p>

<p>To compile <code>/xslt/atom.xsl</code> to <code>/xslt/atom.sef.json</code>,
you can use Saxon-EE or you can install SaxonJS on Node.js and use node,
something like this:</p>

<pre><code>node xslt3.js -xsl:xslt/atom.xsl -export:xslt/atom.sef.json -nogo -ns:##html5</code></pre>

<p>(Depending on your platform, you might have to quote or escape the hashes in <code>-ns:##html5</code>)</p>

<p>That all works. This is an unexplored use case; it’s clear that we could make
it a little simpler by adding some options to the <code>SaxonJS.transform</code>
method.</p>

<p>Not everyone will find this situation wholly satisfying. It’s a little bit
complicated and it introduces an edit-compile-debug cycle into your workflow. You
can’t just use the plain old XSL stylesheet; you have to use the compiled
version. The compiler comes with Saxon-EE and is also available for free on
Node.js, but they aren’t open source.</p>

<p>Other approaches that could be used include
<a href="https://en.wikipedia.org/wiki/Content_negotiation">content negotiation</a> or simply using
redirects. Content negotiation is also a little bit complicated and requires the ability
to configure the web server. Redirects are simpler, but introduce two different
URIs which might be confusing.</p>

<p>With luck, the WHATWG will be persuaded not to break the web and we won’t have to
do any of these things. But there are options.</p>

</main><footer><div class="prev-uri"><a href="/norm/2025/08/20-removing-xslt.html">Removing XSLT from the browser</a></div></footer></body>
</html>